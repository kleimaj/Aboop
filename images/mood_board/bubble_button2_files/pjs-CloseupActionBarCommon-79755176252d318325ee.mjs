(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([["CloseupActionBarCommon"],{pzPq:function(e,t,n){var i=n("xdpg"),a=n("Ye/N");t.a=(e,t)=>{const n=e.link_domain,o=e.tracked_link||e.link||e.images&&e.images.orig&&e.images.orig.url,r=e.rich_metadata,s=e.domain;let c=e.pinner||e.origin_pinner;n&&(c=n.official_user||c);let l="",d="";const u=!(!(r&&r.recipe&&r.recipe.name&&r.recipe.categorized_ingredients)||r.recipe.from_aggregated_data);let p,m;r&&r.products&&r.products[0]&&(p=!!(r&&r.name&&r.offer_summary));const h=e.buyable_product,f=p||h,y=!(!r||!r.article),g=!(!r||!r.tutorial),b=!(!c||!c.username);let _=a.a._("Saved from ","Closeup pin annotation"),E=b?a.a._("Saved by"):a.a._("Saved from"),S=a.a._("Visit");r&&r.products&&r.products[0]&&r&&r.products[0].name&&r.products[0].offer_summary&&(_=a.a._("Product sold by ","pin annotation"),m=r.products[0].offer_summary),f?(E=a.a._("Sold by"),S=a.a._("Visit"),p&&(l=r.products[0].name)):g?(_=a.a._("Saved from ","pin annotation"),E=b?a.a._("Saved by"):a.a._("Saved from"),S=a.a._("Visit")):u?(_=a.a._("Recipe from ","pin annotation"),E=b?a.a._("Recipe by"):a.a._("Recipe from"),S=a.a._("Make it"),l=r.recipe.name,d=r.closeup_description):y&&(_=a.a._("Article from ","pin annotation"),E=b?a.a._("Article by"):a.a._("Article from"),S=a.a._("Read it"),l=r.title);const R=e.rich_summary;if(!m&&R){let e;R&&R.products&&R.products[0]&&(e=!!(R&&R.products[0].name&&R.products[0].offer_summary))&&(_=a.a._("Product sold by ","pin annotation"))}let x,w;b?(x="/"+c.username+"/",w=c.full_name):(x="/source/"+s,w=r&&r.site_name||s);const v=c&&(c.image_medium_url||c.image_small_url)||e.board&&e.board.image_thumbnail_url,I=i.c(a.a._("More from {{ subtitle }}"),{subtitle:w});return l=t?e.closeup_unified_title:l||e.title,d=t?e.closeup_unified_description:d&&d.trim()||e.closeup_description&&e.closeup_description.trim()||e.description&&e.description.trim(),{actionButtonText:S,image:v,link:x,pinLink:o,pin:e,pinCreditPrefix:_,prefixText:E,subtitle:w,title:I,pinTitle:l,pinDescription:d,pinCategory:e.category}}},qlIy:function(e,t,n){n.r(t);var i=n("q1tI"),a=n.n(i),o=n("OPV1"),r=n("ENn1"),s=n("pzPq"),c=n("HEds"),l=n("n6mq"),d=n("YxyV"),u=n("7jH2");var p=e=>{const{pin:t,useUnifiedTitleDescription:n,viewParameter:i}=e,{pinTitle:o,pinDescription:p,pinCategory:m}=Object(s.a)(t,n),h=Object(u.p)({pin:t}),{video:f}=Object(u.y)(h)||{},y=!!f;let g;t.images&&(g=t.embed&&"gif"===t.embed.type?t.embed.src:t.images["736x"]&&t.images["736x"].url);const b=Object(d.h)(t);return a.a.createElement(l.c,{"data-test-id":"pin-action-bar"},a.a.createElement(c.a,{bestPinImgSrc:b,bgColor:"transparent",hideDownload:y,iconColor:"gray",iconSize:"md",pinCategory:m,pinDescription:p,pinId:t.id,pinImgSrc:g,pinTitle:o,reportPin:Object(r.a)({pin:t,viewParameter:i,viewType:3}),usePortal:!1}))},m=n("c4Fo");const h=136;class f extends a.a.Component{constructor(...e){var t,n,i;super(...e),i={paused:!1,showPulsar:!1},(n="state")in(t=this)?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i}componentDidMount(){this.mountPulsar(),this.props.onExperienceMount&&this.experience&&this.props.onExperienceMount(this.experience)}componentWillUnmount(){clearTimeout(this.timer)}mountPulsar(){if(!this.experience)return;const{display_data:e}=this.experience;e.has_pulsar&&this.setState({showPulsar:!0})}renderPulsar(){const{anchor:e}=this.props,{paused:t}=this.state;if(!e)return null;const n=e.getBoundingClientRect(),{height:i,width:o}=n,r=-(h/2+i/2),s=-(h/2-o/2);return a.a.createElement(l.c,{position:"absolute",dangerouslySetInlineStyle:{__style:{zIndex:1,marginTop:r,marginLeft:s,cursor:"pointer",pointerEvents:"none"}}},a.a.createElement(l.B,{paused:t}))}render(){const{anchor:e,experienceIds:t,flyoutSize:n,idealDirection:i,placementId:o,shouldTimeoutDismiss:r,textOverflow:s}=this.props,{showPulsar:c}=this.state;return a.a.createElement(m.a,{experienceIds:t,placementId:o,type:8},t=>{const{complete:o,dismiss:d,display_data:u}=t;return this.experience=t,u.has_pulsar||u.has_tooltip?(r&&u.disappearTime&&u.disappearTime>0&&(this.timer=setTimeout(()=>(d(),null),u.disappearTime)),a.a.createElement(l.c,{dangerouslySetInlineStyle:{__style:{zIndex:10}}},c&&this.renderPulsar(),u.has_tooltip&&(!u.has_pulsar||this.state.paused)&&a.a.createElement(l.k,{anchor:e,color:"blue",idealDirection:i||"down",onDismiss:()=>{},shouldFocus:!1,size:n},a.a.createElement(l.c,{column:12,padding:3},a.a.createElement(l.L,{color:"white",overflow:s,size:"lg",weight:"bold"},u.text))))):(o(),null)})}}var y=n("1Vso");const g=20,b={loaded:{opacity:1,transitionDuration:"0.20s",transitionTimingFunction:"cubic-bezier(0, 0, 0.58, 1)",transitionProperty:"transform, opacity",transform:"translate(0, 5px)",transformOrigin:"center"},fade:{opacity:.1,transitionDuration:"0.30s",transitionTimingFunction:"cubic-bezier(0, 0, 0.58, 1)",transitionProperty:"transform, opacity",transform:"translate(0, 5px)",transformOrigin:"center"}};function _({reactionLabel:e,handleHideConfirmation:t}){const[n,o]=Object(i.useState)("loaded"),r=Object(i.useRef)();return Object(i.useEffect)(()=>{r.current=requestAnimationFrame(()=>{setTimeout(()=>o("fade"),1e3),setTimeout(()=>t(),1300)})},[]),a.a.createElement(l.c,{position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},a.a.createElement(l.c,{shape:"pill",position:"absolute",color:"darkGray",ref:r,height:g,display:"flex",alignItems:"center",justifyContent:"center",paddingY:1,paddingX:2,dangerouslySetInlineStyle:{__style:{...b[n],whiteSpace:"nowrap"}}},a.a.createElement(l.L,{color:"white",size:"xs",weight:"bold",overflow:"normal"},e)))}var E=n("i8i4"),S=n("eo+c");const R=300,x=80,w=-R/2,v=20,I=40,C=24,O=-8,T=9,j={icon:{backgroundRepeat:"no-repeat",backgroundSize:"cover"},loading:{opacity:0,transitionDuration:"0.25s",transitionTimingFunction:"ease-out",transitionProperty:"transform, opacity",transform:"scaleX(1) scaleY(1) translateZ(0) translateY(25px)",transformOrigin:"bottom"},loaded:{opacity:1,transitionDuration:"0.2s",transitionTimingFunction:"ease-out",transitionProperty:"transform, opacity",transform:"scaleX(1) scaleY(1)",transformOrigin:"bottom"},clicked:{transition:"transform 0.2s ease-out",transform:`translateY(-30px) scaleX(${98/I}) scaleY(${98/I})`,transformOrigin:"bottom",position:"relative",zIndex:1},flying:{transition:"transform 0.2s ease-out",transformOrigin:"bottom"},label:{transition:"transform 0.2s ease-out",transform:`scale(${I/98})`,transformOrigin:"bottom",whiteSpace:"nowrap"},fading:{opacity:0,transition:"opacity 0.2s ease-out"}},k={boxShadow:"0 9px 26px rgba(0, 0, 0, 0.4)"};function B({reactionButtonRect:e,handleReactionTrayClick:t}){const[n,o]=Object(i.useState)("loading"),[r,s]=Object(i.useState)(""),[c,d]=Object(i.useState)(),[u,p]=Object(i.useState)(!1),[m,h]=Object(i.useState)({}),[f]=Object(i.useState)(e),y=Object(i.useRef)(),g=Object(i.useRef)({});Object(i.useEffect)(()=>{"loading"===n&&(y.current=requestAnimationFrame(()=>o("loaded"))),(()=>{p(!0);const e={...m};S.c.forEach(t=>{const n=Object(E.findDOMNode)(g.current[t]);g.current[t]&&n instanceof HTMLElement&&!e[t]&&(e[t]=n.getBoundingClientRect())}),Object.keys(e).length===S.c.length&&h(e)})(),!c&&u&&(()=>{const e={...c};S.c.forEach(t=>{const n=m[t],{left:i,top:a}=f,{left:o,top:r}=n,s=i-o+O,c=a-r+T;e[t]={translateX:s,translateY:c}}),d(e)})()},[u,e]);const b=()=>{"clicked"===n&&r&&(o("flying"),setTimeout(()=>{t(r)},750))},_=S.c.map((e,t)=>{const{staticAsset:i,animatedAsset:o,label:s,htmlStyle:d,animationStyle:u}=S.a[e],p={transitionDelay:`${.08*t}s`,...j[n]},m={...r===e?j.clicked:j.loaded},h={...c&&r===e?{transform:`translateZ(0) translateX(${c[e].translateX}px) translateY(${c[e].translateY}px) scaleX(${C/I}) scaleY(${C/I}) `,...j[n]}:j.fading};let f={};return"loading"===n||"loaded"===n?f={...p}:"clicked"===n?f={...m}:"flying"===n&&(f={...h}),a.a.createElement(l.c,{display:"flex",alignSelf:"center",justifyContent:"between",key:t},a.a.createElement(l.c,{maxHeight:I,maxWidth:I,display:"flex",alignItems:"center",justifyContent:"center",position:"relative",dangerouslySetInlineStyle:{__style:{...f}},ref:t=>{g.current[e]=t}},r!==e&&a.a.createElement(l.c,{position:"absolute",top:!0,left:!0,bottom:!0,right:!0},a.a.createElement(l.c,{width:I,height:I,dangerouslySetInlineStyle:{__style:{backgroundImage:`url(${i})`,backgroundPosiiton:"center",backgroundRepeat:"no-repeat",backgroundSize:"cover"}}})),a.a.createElement(l.c,{display:"flex",alignItems:"center",justifyContent:"center",direction:"column",position:"relative"},a.a.createElement("style",{dangerouslySetInnerHTML:{__html:d}}),r===e&&"clicked"===n&&a.a.createElement(l.c,{shape:"pill",color:"darkGray",height:v,dangerouslySetInlineStyle:{__style:j.label},display:"flex",alignItems:"center",justifyContent:"center",paddingY:1,paddingX:2},a.a.createElement(l.L,{color:"white",size:"xs",weight:"bold",overflow:"normal"},s)),a.a.createElement("div",{onClick:b,onKeyDown:b,role:"presentation"},a.a.createElement(l.c,{width:I,height:I,display:"flex",alignItems:"center",justifyContent:"center",dangerouslySetInlineStyle:{__style:{...j.icon,...r===e&&"clicked"===n?{animation:u}:{},backgroundImage:`url(${o})`}}})))))});return a.a.createElement(l.c,{position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",dangerouslySetInlineStyle:{__style:{marginLeft:w}}},a.a.createElement(l.c,{display:"flex",alignItems:"center",justifyContent:"center",width:R,height:x,shape:"pill",color:"flying"===n?"transparent":"white",dangerouslySetInlineStyle:{__style:{..."flying"!==n?k:{}}},onMouseMove:e=>{const{clientX:t}=e;if("flying"!==n){const e=(e=>{let t;return u&&S.c.forEach(n=>{const i=m[n];if(i&&i.left&&i.right){const{left:a,right:o}=i;e>=a&&e<=o&&(t=n)}}),t||null})(t);e!==r&&s(e),o("clicked")}}},a.a.createElement(l.c,{display:"flex",alignItems:"center",justifyContent:"evenly",width:"100%",paddingX:5},_)))}var D=n("eOdZ"),P=n("U4JR"),z=n("zLLH");function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const M=24,H=44,A={base:{borderRadius:"50%"},hovered:{backgroundColor:"rgb(226, 226, 226)"},active:{backgroundColor:"rgb(218, 218, 218)"},focused:{boxShadow:"0 0 0 4px rgba(0, 132, 255, 0.5)",outline:0}};var F=Object(z.c)({name:"ReactionByMeResource",options:({pinId:e})=>({pin_id:e}),key:"reactionByMeResource"})(class extends i.PureComponent{constructor(...e){super(...e),L(this,"state",{clickedReaction:0,isConfirmationShowing:!1,isReactionTrayShowing:!1,reactionButtonRect:null,useInitialReaction:!0}),L(this,"reactionButtonRef",a.a.createRef()),L(this,"onResize",()=>{this.setReactionButtonRect(),this.handleOffHover()}),L(this,"onScroll",()=>{this.setReactionButtonRect(),this.handleOffHover()}),L(this,"handleExperienceMount",e=>{e&&e.complete&&(501977===e.experience_id||501995===e.experience_id)&&(this.tooltipExperience=e)}),L(this,"handleReact",(e=7)=>{const{pinId:t}=this.props,n={pin_id:t,reaction_type:e};this.setState({clickedReaction:e,useInitialReaction:!1}),D.a.create("ReactionsResource",n).callUpdate()}),L(this,"handleUnreact",()=>{const{pinId:e}=this.props,t={pin_id:e};this.setState({clickedReaction:0,useInitialReaction:!1}),D.a.create("ReactionsResource",t).callDelete()}),L(this,"setReactionButtonRect",()=>{if(this.reactionButtonRef.current&&this.reactionButtonRef.current instanceof HTMLElement){const e=this.reactionButtonRef.current.getBoundingClientRect();this.setState({reactionButtonRect:e})}}),L(this,"handleOnHover",()=>{this.setState(e=>({isReactionTrayShowing:!e.isReactionTrayShowing})),this.tooltipExperience&&this.tooltipExperience.complete()}),L(this,"handleOffHover",()=>{this.setState({isReactionTrayShowing:!1})}),L(this,"handleOneTapReactionClick",()=>{const{clickedReaction:e,useInitialReaction:t}=this.state,{reactionByMeResource:n}=this.props,i=n.isLoaded&&n.data&&n.data.reaction_by_me?n.data.reaction_by_me:0;(t?i:e)?this.handleUnreact():this.handleOnHover(),Object(P.a)(101,{view:3,viewParameter:139,element:11354,objectId:this.props.pinId})}),L(this,"handleReactionTrayClick",e=>{this.handleReact(S.a[e].type),this.handleShowConfirmation()}),L(this,"handleShowConfirmation",()=>{this.setState({isConfirmationShowing:!0})}),L(this,"handleHideConfirmation",()=>{this.setState({isConfirmationShowing:!1},this.handleOffHover)})}componentDidMount(){this.setReactionButtonRect(),window.addEventListener("mouseover",this.setReactionButtonRect)}componentWillUnmount(){window.removeEventListener("mouseover",this.setReactionButtonRect)}render(){const{isReactionTrayShowing:e,reactionButtonRect:t,isConfirmationShowing:n,clickedReaction:i,useInitialReaction:o}=this.state,{reactionByMeResource:r,showTooltip:s}=this.props,c=r.isLoaded&&r.data&&r.data.reaction_by_me?r.data.reaction_by_me:0,d=o?c:i,u=d?S.b[d]:"default",{staticAsset:p,animatedAsset:m,label:h}=S.a[u],g=d&&m?m:p;return a.a.createElement(l.c,{position:"relative"},a.a.createElement(y.a,{accessibilityLabel:"reaction",onClick:this.handleOneTapReactionClick,style:{display:"block",border:"none",padding:0,cursor:"pointer",background:"transparent",outline:"none",borderRadius:"50%"}},({active:t,hovered:n,focused:i})=>{let o={...A.base};return t?o={...A.base,...A.active}:n?o={...A.base,...A.hovered}:i&&(o={...A.base,...A.focused}),a.a.createElement(l.c,{color:"transparent",shape:"circle",dangerouslySetInlineStyle:{__style:o}},a.a.createElement(l.c,{display:"flex",justifyContent:"center",alignItems:"center",dangerouslySetInlineStyle:{__style:{minHeight:H,minWidth:H}}},(!e||!!d)&&a.a.createElement(l.c,{height:M,width:M,ref:this.reactionButtonRef,display:"flex",alignItems:"center",justifyContent:"center",dangerouslySetInlineStyle:{__style:{backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundImage:`url(${g})`}}})))}),s&&!e&&!n&&o&&a.a.createElement(f,{experienceIds:[501977,501995],idealDirection:"down",placementId:12,anchor:this.reactionButtonRef.current,flyoutSize:"lg",onExperienceMount:this.handleExperienceMount}),e&&!!t&&!!t.left&&!!t.top&&a.a.createElement(l.c,{display:"flex",justifyContent:"center",alignItems:"center"},a.a.createElement(l.I,{top:0},a.a.createElement(B,{reactionButtonRect:t,handleReactionTrayClick:this.handleReactionTrayClick}))),n&&!!d&&h&&a.a.createElement(_,{reactionLabel:h,handleHideConfirmation:this.handleHideConfirmation}))}}),Y=n("rYoy"),X=n("zXAL"),$=n("/zJj"),U=n("XCz/"),q=n("T5j3");function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"CloseupActionBar",(function(){return W}));const N=Object(i.lazy)(()=>n.e("SecondarySendButtonCommon").then(n.bind(null,"fepT")));class W extends a.a.Component{constructor(e){super(e),V(this,"sendExperienceComplete",()=>{}),V(this,"handleExternalSend",()=>{this.sendExperienceComplete()}),V(this,"onSendExperienceMount",e=>{e&&e.complete&&500946===e.experience_id&&(this.sendExperienceComplete=e.complete)}),V(this,"promoteButtonRef",Object(i.createRef)()),this.sendButtonTooltipRef=a.a.createRef()}render(){const{editable:e,gridDescription:t,hideButtons:n,hidePromoteButton:i,imageSrc:r,inChangeTitlesExp:s,isFlyoutOpen:c,isOnSecretBoard:d,onEditSubmit:u,onFlyoutDismiss:m,onToggleFlyout:h,pin:y,promoteButton:g,saveButton:b,shareButtonRef:_,viewParameter:E}=this.props,S=d?null:a.a.createElement(Y.a,null,a.a.createElement(l.c,null,a.a.createElement("div",{ref:this.sendButtonTooltipRef},a.a.createElement(N,{buttonType:"icon",gridDescription:t,imageSrc:r,isFlyoutOpen:c,onExternalSend:this.handleExternalSend,onFlyoutDismiss:m,onToggleFlyout:h,pinId:y.id,sendType:"pin",shareButtonRef:_})),b&&!c&&a.a.createElement(f,{experienceIds:[500946],placementId:12,anchor:this.sendButtonTooltipRef.current,onExperienceMount:this.onSendExperienceMount}))),R=Object(q.c)(y),x=a.a.createElement(l.c,{display:"flex",color:"white",justifyContent:n?"end":"between",shape:"rounded",maxWidth:$.e},!n&&a.a.createElement(l.c,{display:"flex"},e&&a.a.createElement(l.c,{marginEnd:1},a.a.createElement(o.b,{carouselSlotCurrentIndex:y&&y.carousel_data&&y.carousel_data.index,pinId:y.id,onSubmit:u,view:3,viewParameter:E})),a.a.createElement(p,{pin:y,useUnifiedTitleDescription:s,viewParameter:E})),a.a.createElement(l.c,{alignItems:"center",display:"flex"},S,a.a.createElement(U.a,{name:"web_video_reactions",activate:!0},({anyEnabled:e})=>R&&e&&a.a.createElement(Y.a,null,a.a.createElement(F,{pinId:y.id,showTooltip:!0}))),!i&&g&&a.a.createElement(Y.a,null,a.a.createElement(a.a.Fragment,null,a.a.createElement(l.c,{ref:this.promoteButtonRef},g),a.a.createElement(f,{experienceIds:[501121],idealDirection:"down",placementId:12,anchor:this.promoteButtonRef.current,flyoutSize:"lg"})))));return a.a.createElement(a.a.Fragment,null,a.a.createElement(l.c,{display:"flex",justifyContent:"between"},x,a.a.createElement(l.c,{marginStart:3},b)))}}t.default=Object(X.a)(W)}}]);
//# sourceMappingURL=pjs-CloseupActionBarCommon-79755176252d318325ee.mjs.map
